<div class="d-flex w-100">
  <div class="col-sm-2">
    <!-- Sidebar Component -->
    <app-sidebar
      [channels]="channels"
      [friends]="friends"
      (onSelect)="handleSelect($event.id, $event.type)"
      (onFindFriends)="view === 'CHANNELS' ? handleFindFriends() : handleChannels()"
      (onCreateChannel)="showCreateChannelModal = true"
      [view]="view"
    ></app-sidebar>
  </div>
  <div class="col-sm-10">
    <ng-container *ngIf="view === views.CHANNELS">
      <app-chat-container
        [channelName]="channels.find(ch => ch.id === selectedChannelId)?.name"
        [channelMembers]="channelMembers"
        [isOwner]="channelMembers.some(u => u.id === user.id && u.role.id === roles.OWNER)"
        [isAdmin]="channelMembers.some(u => u.id === user.id && u.role.id === roles.ADMIN)"
        [messages]="messages"
        [friends]="friends"
        (onSendMessage)="handleSendMessage($event)"
        (onDeleteChannel)="handleDeleteChannel()"
      ></app-chat-container>
    </ng-container>
    <ng-container *ngIf="view === views.USERS">
      <app-users-container [friends]="friends"></app-users-container>
    </ng-container>
  </div>
</div>

<!-- Create Channel Modal -->
<ngb-modal [(ngModel)]="showCreateChannelModal">
  <div class="modal-header">
    <h5 class="modal-title">Create Channel</h5>
    <button type="button" class="close" (click)="showCreateChannelModal = false">&times;</button>
  </div>
  <div class="modal-body">
    <div class="form-group">
      <label for="channelName">Channel Name</label>
      <input
        type="text"
        id="channelName"
        [(ngModel)]="newChannelName"
        class="form-control"
        placeholder="Enter channel name"
        required
      />
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn btn-secondary" (click)="showCreateChannelModal = false">Cancel</button>
    <button class="btn btn-primary" (click)="handleCreateChannel()">Create</button>
  </div>
</ngb-modal>
